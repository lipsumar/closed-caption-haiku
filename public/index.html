<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>[Closed Caption Whipsers]</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body class="static-background">
    <h1>
      <span>[CLOSED CAPTION WHISPERS]</span>
    </h1>
    <p>
      <span>
        creates haikus using non-verbal closed captions from movies or TV shows
      </span>
    </p>

    <form action="/generate-haiku" method="post">
      <label for="movieName"
        ><span>Enter a movie<br />or serie title</span></label
      >
      <input type="text" name="movieName" id="movieName" autofocus />
      <button type="submit">Make a Haiku →</button>
    </form>
    <script>
      (() => {
        const formEl = document.querySelector("form");
        formEl.addEventListener("submit", (e) => {
          e.preventDefault();
          const movieName = formEl.querySelector("input").value;
          formEl.innerHTML = `<div class="loading"><span>[COMPUTER WORKING...]</span></div>`;
          console.log(movieName);
          fetch(formEl.action + "?movieName=" + encodeURIComponent(movieName), {
            method: "post",
          })
            .then((resp) => resp.json())
            .then((resp) => {
              window.location.href = `/haiku/${
                resp.id
              }?movieName=${encodeURIComponent(movieName)}`;
            })
            .catch((err) => {
              formEl.innerHTML =
                "Oops, can’t find closed captions for this one";
            });
        });
      })();
    </script>
  </body>
</html>
